# 多人对战功能测试指南

## 🎮 测试环境

### 服务器

- **状态**: ✅ 运行中
- **地址**: `ws://localhost:3000`
- **端口**: 3000

### 前端

- **状态**: ✅ 运行中
- **地址**: `http://localhost:8082/`
- **端口**: 8082

## 🧪 测试步骤

### 1. 打开多个浏览器窗口

在浏览器中打开 2 个或更多窗口访问:

```
http://localhost:8082/
```

### 2. 进入多人对战大厅

每个窗口:

1. 点击主菜单的 **"多人对战"** 按钮
2. 进入大厅界面

### 3. 创建房间

**玩家 1 (房主)**:

1. 点击 **"创建房间"**
2. 输入房间名称（或点击 🎲 随机）
3. 选择最大人数（2-6人）
4. 可选：设置密码
5. 点击 **"创建房间"**

### 4. 加入房间

**玩家 2+**:

1. 点击 **"房间列表"**
2. 找到房主创建的房间
3. 点击 **"加入"** 按钮
   - 如果有密码，需要输入密码

### 5. 开始游戏

**房主**:

1. 等待其他玩家加入
2. 点击 **"开始游戏"** 按钮
   - 人数不足时，AI 会自动填充空位
   - 3 秒倒计时后游戏开始

### 6. 测试游戏功能

#### 移动测试

- `W/A/S/D` - 移动角色
- 检查其他玩家是否能看到你的移动
- 检查移动是否平滑（插值）

#### 攻击测试

- `J` - 轻拳攻击
- `H` - 切换到重拳，`J` 攻击
- `K` - 切换到手枪，`J` 射击
- `L` - 切换到机枪，`J` 连射
- `I` - 切换到狙击枪，`J` 狙击

检查:

- ✅ 近战攻击是否命中
- ✅ 远程子弹是否显示
- ✅ 伤害是否正确
- ✅ 击杀提示是否显示

#### 格挡测试

- `Space` - 格挡
- 被攻击时按住格挡
- 检查伤害是否减半（50%）

#### 血包测试

- 等待 10 秒，血包自动生成
- 走到血包附近拾取
- 检查血量是否恢复
- 检查血包是否消失

### 7. 测试游戏结束

**条件**:

- 只剩 1 人存活
- 或时间到（99秒）

检查:

- ✅ 游戏结束提示
- ✅ 获胜者显示
- ✅ 分数统计

## ✅ 功能检查清单

### 房间管理

- [ ] 创建房间
- [ ] 加入房间（无密码）
- [ ] 加入房间（有密码）
- [ ] 房间列表显示
- [ ] 房主标记 👑
- [ ] AI 标记 🤖
- [ ] 玩家离开
- [ ] 房主离开解散房间

### 游戏功能

- [ ] 倒计时（3秒）
- [ ] 玩家移动同步
- [ ] 玩家旋转同步
- [ ] 近战攻击（轻拳/重拳）
- [ ] 远程攻击（手枪/机枪/狙击枪）
- [ ] 子弹渲染和移动
- [ ] 格挡减伤
- [ ] 血包生成
- [ ] 血包拾取
- [ ] 伤害显示
- [ ] 死亡处理
- [ ] 游戏结束判定

### UI 界面

- [ ] 玩家列表更新
- [ ] 血条显示
- [ ] 武器切换
- [ ] 操作提示

## 🐛 已知问题

1. **血包渲染未实现**
   - 血包会生成和拾取
   - 但客户端不会显示血包图形
   - 不影响游戏逻辑

2. **本地玩家子弹**
   - 本地玩家的子弹由本地 `BulletManager` 管理
   - 远程玩家的子弹由 `RemoteBullet` 渲染
   - 可能需要优化避免重复

3. **AI 未实现**
   - AI 占位符存在
   - 不会移动和攻击
   - 可以被击杀

## 📊 性能监控

### 网络延迟

- 状态同步: 20 Hz (50ms)
- 游戏循环: 60 FPS (16.67ms)
- 插值系数: 0.2-0.3

### 带宽使用

- 每个状态包: ~500 bytes
- 每秒流量: ~10 KB/s
- 峰值（6人）: ~60 KB/s

## 🎯 测试目标

1. **基本功能**: 所有核心功能正常工作
2. **网络同步**: 多个客户端状态一致
3. **用户体验**: 操作流畅，无明显延迟
4. **稳定性**: 长时间运行无崩溃

---

**测试时间**: 2025-12-30
**版本**: v0.9.0 (核心战斗系统)
